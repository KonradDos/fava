
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>beancount.prices &#8212; Fava  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="beancount.prices.sources" href="beancount.prices.sources.html" />
    <link rel="prev" title="beancount.plugins" href="beancount.plugins.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-beancount.prices">
<span id="beancount-prices"></span><h1>beancount.prices<a class="headerlink" href="#module-beancount.prices" title="Permalink to this headline">¶</a></h1>
<p>Fetch prices from the internet and output them as Beancount price directives.</p>
<p>This script accepts a list of Beancount input filenames, and fetches prices
required to compute market values for current positions:</p>
<blockquote>
<div><p>bean-price /home/joe/finances/joe.beancount</p>
</div></blockquote>
<p>The list of fetching jobs to carry out is derived automatically from the input
file (see section below for full details). It is also possible to provide a list
of specific price fetching jobs to run, e.g.,</p>
<blockquote>
<div><p>bean-price -e google/TSE:XUS yahoo/AAPL mysources.morningstar/RBF1005</p>
</div></blockquote>
<p>The general format of each of these “source strings” is</p>
<blockquote>
<div><p>&lt;module&gt;/[^]&lt;ticker&gt;</p>
</div></blockquote>
<p>The “module” is the name of a Python module that contains a Source class which
can be instantiated and connect to a data source to extract price data. These
modules are automatically imported by name and instantiated in order to pull the
price from a particular data source. This allows you to write your own
supplementary fetcher codes without having to modify this script.</p>
<p>Default implementations are provided to provide access to prices from Yahoo!
Finance or Google Finance, which cover a large universe of common public
investment types (e.g. stock tickers). As a convenience, the module name is
always first searched under the “beancount.prices.sources” package, where those
default source implementations live. This is how, for example, in order to use
the provided Google Finance data fetcher you don’t have to write
“beancount.prices.sources.yahoo/AAPL” but simply “yahoo/AAPL”.</p>
<div class="section" id="date">
<h2>Date<a class="headerlink" href="#date" title="Permalink to this headline">¶</a></h2>
<p>By default, this script will fetch prices at the latest available date &amp; time.
You can use an option to fetch historical prices for a desired date instead:</p>
<blockquote>
<div><p>bean-price –date=2015-02-03</p>
</div></blockquote>
</div>
<div class="section" id="inverse">
<h2>Inverse<a class="headerlink" href="#inverse" title="Permalink to this headline">¶</a></h2>
<p>Sometimes, prices are available for the inverse of an instrument. This is often
the case for currencies. For example, the price of “CAD” in USD” is provided by
the USD/CAD market, which gives the price of a US dollar in Canadian dollars. In
order specify this, you can prepend “^” to the instrument to instruct the driver
to compute the inverse of the given price:</p>
<blockquote>
<div><p>bean-price -e USD:google/^CURRENCY:USDCAD</p>
</div></blockquote>
<p>If a source price is to be inverted, like this, the precision could be different
than what is fetched. For instance, if the price of USD/CAD is 1.32759, it would
output be this from the above directive:</p>
<blockquote>
<div><p>2015-10-28 price CAD  0.753244601119 USD</p>
</div></blockquote>
<p>By default, inverted rates will be rounded similarly to how other Price
directives were rounding those numbers.</p>
</div>
<div class="section" id="swap-inverted">
<h2>Swap Inverted<a class="headerlink" href="#swap-inverted" title="Permalink to this headline">¶</a></h2>
<p>If you prefer to have the output Price entries with swapped currencies instead
of inverting the rate itself, you can use the –swap-inverted option. In the
previous example for the price of CAD, it would output this:</p>
<blockquote>
<div><p>2015-10-28 price USD   1.32759 CAD</p>
</div></blockquote>
<p>This works since the Beancount price database computes and interpolates the
reciprocals automatically for all pairs of commodities in its database.</p>
</div>
<div class="section" id="prices-needed-for-a-beancount-file">
<h2>Prices Needed for a Beancount File<a class="headerlink" href="#prices-needed-for-a-beancount-file" title="Permalink to this headline">¶</a></h2>
<p>You can also provide a filename to extract the list of tickers to fetch from a
Beancount input file, e.g.:</p>
<blockquote>
<div><p>bean-price /home/joe/finances/joe.beancount</p>
</div></blockquote>
<p>There are many ways to extract a list of commodities with needed prices from a
Baancount input file:</p>
<ul>
<li><p>Prices for all the holdings that were seen held-at-cost at a particular date.</p></li>
<li><p>Prices for holdings held at a particular date which were price converted from
some other commodity in the past (i.e., for currencies).</p></li>
<li><p>The list of all Commodity directives present in the file. For each of those
holdings, the corresponding Commodity directive is consulted and its “ticker”
metadata field is used to specify where to attempt to fetch prices. You should
have directives like this in your input file:</p>
<blockquote>
<div><dl class="simple">
<dt>2007-07-20 commodity VEA</dt><dd><p>price: “google/NYSEARCA:VEA”</p>
</dd>
</dl>
</div></blockquote>
<p>The “price” metadata can be a comma-separated list of sources to try out, in
which case each of the sources will be looked at :</p>
<blockquote>
<div><dl class="simple">
<dt>2007-07-20 commodity VEA</dt><dd><p>price: “google/CURRENCY:USDCAD,yahoo/USDCAD”</p>
</dd>
</dl>
</div></blockquote>
</li>
<li><p>Existing price directives for the same data are excluded by default, since the
price is already in the file.</p></li>
</ul>
<p>By default, the list of tickers to be fetched includes only the intersection of
these lists. The general intent of the user of this script is to fetch missing
prices, and only needed ones, for a particular date.</p>
<ul class="simple">
<li><p>Use the –date option to change the applied date.</p></li>
<li><p>Use the –all option to fetch the entire set of prices, regardless
of holdings and date.</p></li>
<li><p>Use –clobber to ignore existing price directives.</p></li>
</ul>
<p>You can also print the list of prices to be fetched with the –dry-run option,
which stops short of actually fetching the missing prices (it just prints the
list of fetches it would otherwise attempt).</p>
</div>
<div class="section" id="caching">
<h2>Caching<a class="headerlink" href="#caching" title="Permalink to this headline">¶</a></h2>
<p>Prices are automatically cached. You can disable the cache with an option:</p>
<blockquote>
<div><p>bean-price –no-cache</p>
</div></blockquote>
<p>You can also instruct the script to clear the cache before fetching its prices:</p>
<blockquote>
<div><p>bean-price –clear-cache</p>
</div></blockquote>
</div>
<div class="section" id="about-sources-and-data-availability">
<h2>About Sources and Data Availability<a class="headerlink" href="#about-sources-and-data-availability" title="Permalink to this headline">¶</a></h2>
<p>IMPORTANT: Note that each source may support a different routine for getting its
latest data and for fetching historical/dated data, and that each of these may
differ in their support. For example, Google Finance does not support fetching
historical data for its CURRENCY:* instruments.</p>
</div>
<div class="section" id="module-beancount.prices.find_prices">
<span id="beancount-prices-find-prices"></span><h2>beancount.prices.find_prices<a class="headerlink" href="#module-beancount.prices.find_prices" title="Permalink to this headline">¶</a></h2>
<p>A library of codes create price fetching jobs from strings and files.</p>
</div>
<div class="section" id="module-beancount.prices.price">
<span id="beancount-prices-price"></span><h2>beancount.prices.price<a class="headerlink" href="#module-beancount.prices.price" title="Permalink to this headline">¶</a></h2>
<p>Driver code for the price script.</p>
</div>
<div class="section" id="module-beancount.prices.source">
<span id="beancount-prices-source"></span><h2>beancount.prices.source<a class="headerlink" href="#module-beancount.prices.source" title="Permalink to this headline">¶</a></h2>
<p>Interface definition for all price sources.</p>
<p>This module describes the contract to be fulfilled by all implementations of
price sources.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">Fava</h1>
    
  </a>
</p>



<p class="blurb">Web interface for <a href="http://furius.ca/beancount/">Beancount</a></p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fava.html">fava</a></li>
<li class="toctree-l2"><a class="reference internal" href="fava.core.html">fava.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="fava.ext.html">fava.ext</a></li>
<li class="toctree-l2"><a class="reference internal" href="fava.ext.portfolio_list.html">fava.ext.portfolio_list</a></li>
<li class="toctree-l2"><a class="reference internal" href="fava.help.html">fava.help</a></li>
<li class="toctree-l2"><a class="reference internal" href="fava.plugins.html">fava.plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="fava.util.html">fava.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.html">beancount</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.core.html">beancount.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.ingest.html">beancount.ingest</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.ingest.importers.html">beancount.ingest.importers</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.ingest.importers.mixins.html">beancount.ingest.importers.mixins</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.ops.html">beancount.ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.parser.html">beancount.parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.plugins.html">beancount.plugins</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">beancount.prices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#date">Date</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inverse">Inverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#swap-inverted">Swap Inverted</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prices-needed-for-a-beancount-file">Prices Needed for a Beancount File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#caching">Caching</a></li>
<li class="toctree-l3"><a class="reference internal" href="#about-sources-and-data-availability">About Sources and Data Availability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-beancount.prices.find_prices">beancount.prices.find_prices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-beancount.prices.price">beancount.prices.price</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-beancount.prices.source">beancount.prices.source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="beancount.prices.sources.html">beancount.prices.sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.query.html">beancount.query</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.reports.html">beancount.reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.scripts.html">beancount.scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.tools.html">beancount.tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.utils.html">beancount.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="beancount.web.html">beancount.web</a></li>
</ul>
</li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://github.com/beancount/fava">fava @ GitHub</a></li>
    
    <li class="toctree-l1"><a href="https://gitter.im/beancount/fava">Chat</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/beancount/fava/issues">Issue Tracker</a></li>
    
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Dominik Aumayr.
      
      |
      <a href="../_sources/api/beancount.prices.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>